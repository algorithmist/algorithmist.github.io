<html>
  <head>
    <meta charset="utf-8">
    <script src="https://d3js.org/d3.v5.js"></script>
    <script src="https://dagrejs.github.io/project/dagre-d3/latest/dagre-d3.min.js"></script>
    <script src="trie.js"></script>
  <style>
    .node {
      stroke: #000000;
      fill: #ffffff;
    }
    .node-root {
      stroke: #00ff00;
    }
    .node-keyword {
      stroke: #ff0000;
    }
    .node-cursor {
      stroke-width: 1.5px;
    }
    .edgePath {
      stroke: #000000;
      stroke-width: 1.5px;
    }
    text {
      font-weight: 300;
      font-family: sans-serif;
      font-size: 14px;
    }
  </style>
  </head>
  <body>
  <div id="test1">
    <svg width="30em" height="18em"><g></g></svg>
    <form onsubmit="return false">
      <input type="text" autocomplete="off" id="keyword_text"></br>
      <span id="keyword_span"></span>
    </form>
  </div>
<script>
var trie = new Trie();
var cursor = trie;

trie.renderTo("#test1", cursor);
var keyword_text = document.getElementById("keyword_text");
keyword_text.addEventListener("keydown", function(event) {
  var isAscii =
    (65 <= event.keyCode && event.keyCode <= 90) ||
    (48 <= event.keyCode && event.keyCode <= 57);
  var isBackspace = event.keyCode == 8;
  var isEnter = event.keyCode == 13;
  if (!(isAscii || isBackspace || isEnter)) {
    // Prevent the character from appearing in the text box.
    event.preventDefault();
  }
  return isAscii;
});
keyword_text.addEventListener("keyup", function(event) {
  console.log(event.keyCode);
  var isAscii =
    (65 <= event.keyCode && event.keyCode <= 90) ||
    (48 <= event.keyCode && event.keyCode <= 57);
  var isBackspace = event.keyCode == 8;
  var isEnter = event.keyCode == 13;
  if (isEnter) {
    event.preventDefault();
    var span = document.getElementById("keyword_span");
    var text = document.getElementById("keyword_text");
    span.innerHTML += " " + text.value;
    text.value = "";
    cursor.completeWord();
    cursor = trie;
  } else if (isAscii) {
    cursor = cursor.addCharacter(String.fromCharCode(event.keyCode));
  } else if (isBackspace) {
    cursor = cursor.pop();
  } else {
    return;
  }
  trie.renderTo("#test1", cursor);
});
</script>
  </body>
</html>
